!function(){function e(){return"x"+ ++y+ +new Date}function t(){return+new Date}function r(n,e){var t=n.join(A),r=[];return e?(f(e,function(n,e){var t="object"==typeof e?JSON.stringify(e):e;"undefined"!=typeof e&&null!=e&&p(t).length>0&&r.push(n+"="+p(t))}),t+="?"+r.join(I)):t}function a(n,e){var r,i=0,a=function(){i+e>t()?(clearTimeout(r),r=setTimeout(a,e)):(i=t(),n())};return a}function o(n,e){var t=[];return f(n||[],function(n){e(n)&&t.push(n)}),t}function c(n,e){return n.replace(U,function(n,t){return e[t]||n})}function u(n,e){return setTimeout(n,e)}function s(n){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var e=16*Math.random()|0,t="x"==n?e:3&e|8;return t.toString(16)});return n&&n(e),e}function d(n){return!!n&&Array.isArray&&Array.isArray(n)}function f(n,e){if(n&&e)if(d(n))for(var t=0,r=n.length;r>t;)e.call(n[t],n[t],t++);else for(var t in n)n.hasOwnProperty&&n.hasOwnProperty(t)&&e.call(n[t],t,n[t])}function l(n,e){var t=[];return f(n||[],function(n,r){t.push(e(n,r))}),t}function p(n){return encodeURIComponent(n)}function h(n,e){var t=[];return f(n,function(n,r){e?n.search("-pnpres")<0&&r.subscribed&&t.push(n):r.subscribed&&t.push(n)}),t.sort()}function b(n,e){var t=[];return f(n,function(n,r){e?channel.search("-pnpres")<0&&r.subscribed&&t.push(n):r.subscribed&&t.push(n)}),t.sort()}function g(){u(function(){_||(_=1,f(w,function(n){n()}))},x)}function v(r){function i(n){return n||(n={}),f(Ae,function(e,t){e in n||(n[e]=t)}),n}function v(n){var e=[];return f(n,function(n){e.push(n)}),e}function m(n){return v(n).sort()}function y(n){var e="",t=m(n);for(var r in t){var i=t[r];e+=i+"="+p(n[i]),r!=t.length-1&&(e+="&")}return e}function A(n,e,t){var r=!1;if("number"==typeof n)r=n>P||0==n?!1:!0;else{if("boolean"==typeof n)return n?E:0;r=!0}return r?(t&&t("Presence Heartbeat value invalid. Valid range ( x > "+P+" or x = 0). Current Value : "+(e||P)),e||P):n}function I(n,e){return Le.encrypt(n,e||Ue)||n}function U(n,e){return Le.decrypt(n,e||Ue)||Le.decrypt(n,Ue)||n}function L(){return clearTimeout(_e),!Te||Te>=500||1>Te||!h(me,!0).length?void(Se=!1):(Se=!0,void Ne.presence_heartbeat({callback:function(){_e=u(L,Te*x)},error:function(n){Ie&&Ie("Presence Heartbeat unable to reach Pubnub servers."+JSON.stringify(n)),_e=u(L,Te*x)}}))}function N(){!Se&&L()}function j(n){if(Ce){if(!se.length)return}else{if(n&&(se.sending=0),se.sending||!se.length)return;se.sending=1}xe(se.shift())}function D(n){var e=0;return f(h(me),function(t){var r=me[t];r&&(e++,(n||function(){})(r))}),e}function R(n,e,t){if("object"==typeof n){if(n.error&&n.message&&n.payload)return void t({message:n.message,payload:n.payload});if(n.payload)return void e(n.payload)}e(n)}function K(n,e){e("object"==typeof n&&n.error&&n.message&&n.payload?{message:n.message,payload:n.payload}:n)}function H(n,e,t,r){var e=n.callback||e,a=n.error||Ie,o=Ee(),c=[oe,"v1","channel-registration","sub-key",ne];c.push.apply(c,t),xe({callback:o,data:i(r),success:function(n){R(n,e,a)},fail:function(n){K(n,a)},url:c})}function W(){Pe()||G(1,{error:"Offline. Please check your network settings. "}),V&&clearTimeout(V),V=u(W,x)}function F(){Ne.time(function(n){z(function(){},n),n||G(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."}),Y&&clearTimeout(Y),Y=u(F,X)})}function G(n,e){he&&he(n,e),he=null,clearTimeout(V),clearTimeout(Y)}function J(n){var e=t()-fe;return e-n/1e4}function z(n,e){function r(e){if(e){var r=e/1e4,a=(t()-i)/2;fe=t()-(r+a),n&&n(fe)}}var i=t();e&&r(e)||Ne.time(r)}var V,Y,q=+r.windowing||S,Q=(+r.timeout||C)*x,X=(+r.keepalive||M)*x,Z=r.noleave||0,$=r.publish_key||"demo",ne=r.subscribe_key||"demo",ee=r.auth_key||"",te=r.secret_key||"",re=r.hmac_SHA256,ie=r.ssl?"s":"",ae="http"+ie+"://"+(r.origin||"pubsub.pubnub.com"),oe=O(ae),ce=O(ae),ue=function(){},se=[],de=!0,fe=0,le=0,pe=0,he=0,be=r.restore||0,ge=0,ve=!1,me={},ye={},ke={},_e=null,we=A(r.heartbeat||r.pnexpires||0,r.error),Te=r.heartbeat_interval||we-3,Se=!1,Ce=r.no_wait_for_pending,Me=r["compatible_3.5"]||!1,xe=r.xdr,Ae=r.params||{},Ie=r.error||function(){},Pe=r._is_online||function(){return 1},Ee=r.jsonp_cb||function(){return 0},Be=r.db||{get:function(){},set:function(){}},Ue=r.cipher_key,Oe=r.uuid||Be&&Be.get(ne+"uuid")||"",Le=r.crypto_obj||{encrypt:function(n){return n},decrypt:function(n){return n}},Ne={LEAVE:function(n,e,t,r){var a={uuid:Oe,auth:ee},o=O(ae),t=t||function(){},c=r||function(){},u=Ee();if(n.indexOf(T)>0)return!0;if(Me){if(!ie)return!1;if("0"==u)return!1}return Z?!1:("0"!=u&&(a.callback=u),xe({blocking:e||ie,timeout:2e3,callback:u,data:i(a),success:function(n){R(n,t,c)},fail:function(n){K(n,c)},url:[o,"v2","presence","sub_key",ne,"channel",p(n),"leave"]}),!0)},set_resumed:function(n){ve=n},get_cipher_key:function(){return Ue},set_cipher_key:function(n){Ue=n},raw_encrypt:function(n,e){return I(n,e)},raw_decrypt:function(n,e){return U(n,e)},get_heartbeat:function(){return we},set_heartbeat:function(n){we=A(n,Te,Ie),Te=we-3>=1?we-3:1,ue(),L()},get_heartbeat_interval:function(){return Te},set_heartbeat_interval:function(n){Te=n,L()},get_version:function(){return B},getGcmMessageObject:function(n){return{data:n}},getApnsMessageObject:function(n){var e={aps:{badge:1,alert:""}};for(k in n)k[e]=n[k];return e},newPnMessage:function(){var e={};gcm&&(e.pn_gcm=gcm),apns&&(e.pn_apns=apns);for(k in n)e[k]=n[k];return e},_add_param:function(n,e){Ae[n]=e},channel_group:function(n,e){var t,r,i=n.channel_group,a=n.channels||n.channel,o=n.cloak,c=[],u={},s=n.mode||"add";if(i){var f=i.split(":");f.length>1?(t="*"===f[0]?null:f[0],r=f[1]):r=f[0]}t&&c.push("namespace")&&c.push(p(t)),c.push("channel-group"),r&&"*"!==r&&c.push(r),a?(d(a)&&(a=a.join(",")),u[s]=a,u.cloak=de?"true":"false"):"remove"===s&&c.push("remove"),"undefined"!=typeof o&&(u.cloak=o?"true":"false"),H(n,e,c,u)},channel_group_list_groups:function(n,e){var t;t=n.namespace||n.ns||n.channel_group||null,t&&(n.channel_group=t+":*"),Ne.channel_group(n,e)},channel_group_list_channels:function(n,e){return n.channel_group?void Ne.channel_group(n,e):Ie("Missing Channel Group")},channel_group_remove_channel:function(n,e){return n.channel_group?n.channel||n.channels?(n.mode="remove",void Ne.channel_group(n,e)):Ie("Missing Channel"):Ie("Missing Channel Group")},channel_group_remove_group:function(n,e){return n.channel_group?n.channel?Ie("Use channel_group_remove_channel if you want to remove a channel from a group."):(n.mode="remove",void Ne.channel_group(n,e)):Ie("Missing Channel Group")},channel_group_add_channel:function(n,e){return n.channel_group?n.channel||n.channels?void Ne.channel_group(n,e):Ie("Missing Channel"):Ie("Missing Channel Group")},channel_group_cloak:function(n,e){return"undefined"==typeof n.cloak?void e(de):(de=n.cloak,void Ne.channel_group(n,e))},channel_group_list_namespaces:function(n,e){var t=["namespace"];H(n,e,t)},channel_group_remove_namespace:function(n,e){var t=["namespace",n.namespace,"remove"];H(n,e,t)},history:function(n,e){var e=n.callback||e,t=n.count||n.limit||100,r=n.reverse||"false",a=n.error||function(){},o=n.auth_key||ee,c=n.cipher_key,u=n.channel,s=n.channel_group,d=n.start,f=n.end,l=n.include_token,h={},b=Ee();return u||s?e?ne?(h.stringtoken="true",h.count=t,h.reverse=r,h.auth=o,s&&(h["channel-group"]=s,u||(u=",")),b&&(h.callback=b),d&&(h.start=d),f&&(h.end=f),l&&(h.include_token="true"),void xe({callback:b,data:i(h),success:function(n){if("object"==typeof n&&n.error)return void a({message:n.message,payload:n.payload});for(var t=n[0],r=[],i=0;i<t.length;i++){var o=U(t[i],c);try{r.push(JSON.parse(o))}catch(u){r.push(o)}}e([r,n[1],n[2]])},fail:function(n){K(n,a)},url:[oe,"v2","history","sub-key",ne,"channel",p(u)]})):Ie("Missing Subscribe Key"):Ie("Missing Callback"):Ie("Missing Channel")},replay:function(n,e){var t,e=e||n.callback||function(){},r=n.auth_key||ee,a=n.source,o=n.destination,c=n.stop,u=n.start,s=n.end,d=n.reverse,f=n.limit,l=Ee(),p={};return a?o?$?ne?("0"!=l&&(p.callback=l),c&&(p.stop="all"),d&&(p.reverse="true"),u&&(p.start=u),s&&(p.end=s),f&&(p.count=f),p.auth=r,t=[oe,"v1","replay",$,ne,a,o],void xe({callback:l,success:function(n){R(n,e,err)},fail:function(){e([0,"Disconnected"])},url:t,data:i(p)})):Ie("Missing Subscribe Key"):Ie("Missing Publish Key"):Ie("Missing Destination Channel"):Ie("Missing Source Channel")},auth:function(n){ee=n,ue()},time:function(n){var e=Ee();xe({callback:e,data:i({uuid:Oe,auth:ee}),timeout:5*x,url:[oe,"time",e],success:function(e){n(e[0])},fail:function(){n(0)}})},publish:function(n,e){var t=n.message;if(!t)return Ie("Missing Message");var r,e=e||n.callback||t.callback||function(){},a=n.channel||t.channel,o=n.auth_key||ee,c=n.cipher_key,u=n.error||t.error||function(){},s=n.post||!1,d="store_in_history"in n?n.store_in_history:!0,f=Ee(),l="push";return n.prepend&&(l="unshift"),a?$?ne?(t.getPubnubMessage&&(t=t.getPubnubMessage()),t=JSON.stringify(I(t,c)),r=[oe,"publish",$,ne,0,p(a),f,p(t)],Ae={uuid:Oe,auth:o},d||(Ae.store="0"),se[l]({callback:f,timeout:5*x,url:r,data:i(Ae),fail:function(n){K(n,u),j(1)},success:function(n){R(n,e,u),j(1)},mode:s?"POST":"GET"}),void j()):Ie("Missing Subscribe Key"):Ie("Missing Publish Key"):Ie("Missing Channel")},unsubscribe:function(n,e){var t=n.channel,r=n.channel_group,e=e||n.callback||function(){},i=n.error||function(){};ge=0,t&&(t=l((t.join?t.join(","):""+t).split(","),function(n){return me[n]?n+","+n+T:void 0}).join(","),f(t.split(","),function(n){var t=!0;n&&(_&&(t=Ne.LEAVE(n,0,e,i)),t||e({action:"leave"}),me[n]=0,n in ke&&delete ke[n])})),r&&(r=l((r.join?r.join(","):""+r).split(","),function(n){return ye[n]?n+","+n+T:void 0}).join(","),f(r.split(","),function(){var n=!0;r&&(_&&(n=Ne.LEAVE(r,0,e,i)),n||e({action:"leave"}),ye[r]=0,r in ke&&delete ke[r])})),ue()},subscribe:function(n,e){function r(n){n?u(ue,x):(oe=O(ae,1),ce=O(ae,1),u(function(){Ne.time(r)},x)),D(function(e){return n&&e.disconnected?(e.disconnected=0,e.reconnect(e.name)):void(n||e.disconnected||(e.disconnected=1,e.disconnect(e.name)))})}function a(){var n=Ee(),e=h(me).join(","),t=b(ye).join(",");if(e||t){e||(e=","),G();var o=i({uuid:Oe,auth:s});t&&(o["channel-group"]=t);var c=JSON.stringify(ke);c.length>2&&(o.state=JSON.stringify(ke)),we&&(o.heartbeat=we),N(),he=xe({timeout:A,callback:n,fail:function(n){K(n,m),Ne.time(r)},data:i(o),url:[ce,"subscribe",ne,p(e),n,ge],success:function(n){if(!n||"object"==typeof n&&"error"in n&&n.error)return m(n.error),u(ue,x);if(y(n[1]),ge=!ge&&be&&Be.get(ne)||n[1],D(function(n){n.connected||(n.connected=1,n.connect(n.name))}),ve&&!be)return ge=0,ve=!1,Be.set(ne,0),void u(a,I);C&&(ge=1e4,C=0),Be.set(ne,n[1]);var e=function(){var e="";e=n.length>3?n[3]:n.length>2?n[2]:l(h(me),function(e){return l(Array(n[0].length).join(",").split(","),function(){return e})}).join(",");var t=e.split(",");return function(){var n=t.shift()||pe;return[(me[n]||{}).callback||le,n.split(T)[0]]}}(),t=J(+n[1]);f(n[0],function(r){var i=e(),a=U(r,me[i[1]]?me[i[1]].cipher_key:null);i[0](a,n,i[2]||i[1],t)}),u(a,I)}})}}var o=n.channel,c=n.channel_group,e=e||n.callback,e=e||n.message,s=n.auth_key||ee,d=n.connect||function(){},g=n.reconnect||function(){},v=n.disconnect||function(){},m=n.error||function(){},y=n.idle||function(){},k=n.presence||0,S=n.noheresync||0,C=n.backfill||0,M=n.timetoken||0,A=n.timeout||Q,I=n.windowing||q,P=n.state,E=n.heartbeat||n.pnexpires,B=n.restore||be;return be=B,ge=M,o||c?e?ne?((E||0===E)&&Ne.set_heartbeat(E),o&&f((o.join?o.join(","):""+o).split(","),function(r){var i=me[r]||{};me[pe=r]={name:r,connected:i.connected,disconnected:i.disconnected,subscribed:1,callback:le=e,cipher_key:n.cipher_key,connect:d,disconnect:v,reconnect:g},P&&(ke[r]=r in P?P[r]:P),k&&(Ne.subscribe({channel:r+T,callback:k,restore:B}),i.subscribed||S||Ne.here_now({channel:r,callback:function(n){f("uuids"in n?n.uuids:[],function(e){k({action:"join",uuid:e,timestamp:Math.floor(t()/1e3),occupancy:n.occupancy||1},n,r)})}}))}),c&&f((c.join?c.join(","):""+c).split(","),function(r){var i=ye[r]||{};ye[r]={name:r,connected:i.connected,disconnected:i.disconnected,subscribed:1,callback:le=e,cipher_key:n.cipher_key,connect:d,disconnect:v,reconnect:g},k&&(Ne.subscribe({channel_group:r+T,callback:k,restore:B}),i.subscribed||S||Ne.here_now({channel_group:r,callback:function(n){f("uuids"in n?n.uuids:[],function(e){k({action:"join",uuid:e,timestamp:Math.floor(t()/1e3),occupancy:n.occupancy||1},n,r)})}}))}),ue=function(){G(),u(a,I)},_?void ue():w.push(ue)):Ie("Missing Subscribe Key"):Ie("Missing Callback"):Ie("Missing Channel")},here_now:function(n,e){var e=n.callback||e,t=n.error||function(){},r=n.auth_key||ee,a=n.channel,o=n.channel_group,c=Ee(),u="uuids"in n?n.uuids:!0,s=n.state,d={uuid:Oe,auth:r};if(u||(d.disable_uuids=1),s&&(d.state=1),!e)return Ie("Missing Callback");if(!ne)return Ie("Missing Subscribe Key");var f=[oe,"v2","presence","sub_key",ne];a&&f.push("channel")&&f.push(p(a)),"0"!=c&&(d.callback=c),o&&(d["channel-group"]=o,!a&&f.push("channel")&&f.push(",")),xe({callback:c,data:i(d),success:function(n){R(n,e,t)},fail:function(n){K(n,t)},url:f})},where_now:function(n,e){var e=n.callback||e,t=n.error||function(){},r=n.auth_key||ee,a=Ee(),o=n.uuid||Oe,c={auth:r};return e?ne?("0"!=a&&(c.callback=a),void xe({callback:a,data:i(c),success:function(n){R(n,e,t)},fail:function(n){K(n,t)},url:[oe,"v2","presence","sub_key",ne,"uuid",p(o)]})):Ie("Missing Subscribe Key"):Ie("Missing Callback")},state:function(n,e){var t,e=n.callback||e||function(){},r=n.error||function(){},a=n.auth_key||ee,o=Ee(),c=n.state,u=n.uuid||Oe,s=n.channel,d=n.channel_group,f=i({auth:a});return ne?u?s||d?("0"!=o&&(f.callback=o),"undefined"!=typeof s&&me[s]&&me[s].subscribed&&c&&(ke[s]=c),"undefined"!=typeof d&&ye[d]&&ye[d].subscribed&&(c&&(ke[d]=c),f["channel-group"]=d,s||(s=",")),f.state=JSON.stringify(c),t=c?[oe,"v2","presence","sub-key",ne,"channel",s,"uuid",u,"data"]:[oe,"v2","presence","sub-key",ne,"channel",s,"uuid",p(u)],void xe({callback:o,data:i(f),success:function(n){R(n,e,r)},fail:function(n){K(n,r)},url:t})):Ie("Missing Channel"):Ie("Missing UUID"):Ie("Missing Subscribe Key")},grant:function(n,e){var e=n.callback||e,t=n.error||function(){},r=n.channel,a=n.channel_group,o=Ee(),c=n.ttl,u=n.read?"1":"0",s=n.write?"1":"0",d=n.manage?"1":"0",f=n.auth_key;if(!e)return Ie("Missing Callback");if(!ne)return Ie("Missing Subscribe Key");if(!$)return Ie("Missing Publish Key");if(!te)return Ie("Missing Secret Key");var l=Math.floor((new Date).getTime()/1e3),p=ne+"\n"+$+"\ngrant\n",h={w:s,r:u,timestamp:l};n.manage&&(h.m=d),"undefined"!=typeof r&&null!=r&&r.length>0&&(h.channel=r),"undefined"!=typeof a&&null!=a&&a.length>0&&(h["channel-group"]=a),"0"!=o&&(h.callback=o),(c||0===c)&&(h.ttl=c),f&&(h.auth=f),h=i(h),f||delete h.auth,p+=y(h);var b=re(p,te);b=b.replace(/\+/g,"-"),b=b.replace(/\//g,"_"),h.signature=b,xe({callback:o,data:h,success:function(n){R(n,e,t)},fail:function(n){K(n,t)},url:[oe,"v1","auth","grant","sub-key",ne]})},audit:function(n,e){var e=n.callback||e,t=n.error||function(){},r=n.channel,a=n.channel_group,o=n.auth_key,c=Ee();if(!e)return Ie("Missing Callback");if(!ne)return Ie("Missing Subscribe Key");if(!$)return Ie("Missing Publish Key");if(!te)return Ie("Missing Secret Key");var u=Math.floor((new Date).getTime()/1e3),s=ne+"\n"+$+"\naudit\n",d={timestamp:u};"0"!=c&&(d.callback=c),"undefined"!=typeof r&&null!=r&&r.length>0&&(d.channel=r),"undefined"!=typeof a&&null!=a&&a.length>0&&(d["channel-group"]=a),o&&(d.auth=o),d=i(d),o||delete d.auth,s+=y(d);var f=re(s,te);f=f.replace(/\+/g,"-"),f=f.replace(/\//g,"_"),d.signature=f,xe({callback:c,data:d,success:function(n){R(n,e,t)},fail:function(n){K(n,t)},url:[oe,"v1","auth","audit","sub-key",ne]})},revoke:function(n,e){n.read=!1,n.write=!1,Ne.grant(n,e)},set_uuid:function(n){Oe=n,ue()},get_uuid:function(){return Oe},presence_heartbeat:function(n){var e=n.callback||function(){},t=n.error||function(){},r=Ee(),a={uuid:Oe,auth:ee},o=JSON.stringify(ke);o.length>2&&(a.state=JSON.stringify(ke)),we>0&&320>we&&(a.heartbeat=we),"0"!=r&&(a.callback=r);var c=p(h(me,!0).join(",")),u=b(ye,!0).join(",");c||(c=","),u&&(a["channel-group"]=u),xe({callback:r,data:i(a),timeout:5*x,url:[oe,"v2","presence","sub-key",ne,"channel",c,"heartbeat"],success:function(n){R(n,e,t)},fail:function(n){K(n,t)}})},stop_timers:function(){clearTimeout(V),clearTimeout(Y)},xdr:xe,ready:g,db:Be,uuid:s,map:l,each:f,"each-channel":D,grep:o,offline:function(){G(1,{message:"Offline. Please check your network settings."})},supplant:c,now:t,unique:e,updater:a};return Oe||(Oe=Ne.uuid()),Be.set(ne+"uuid",Oe),V=u(W,x),Y=u(F,X),_e=u(N,(Te-3)*x),z(),Ne}function m(){function n(n){function e(n,e){var t=(65535&n)+(65535&e),r=(n>>16)+(e>>16)+(t>>16);return r<<16|65535&t}function t(n,e){return n>>>e|n<<32-e}function r(n,e){return n>>>e}function i(n,e,t){return n&e^~n&t}function a(n,e,t){return n&e^n&t^e&t}function o(n){return t(n,2)^t(n,13)^t(n,22)}function c(n){return t(n,6)^t(n,11)^t(n,25)}function u(n){return t(n,7)^t(n,18)^r(n,3)}function s(n){return t(n,17)^t(n,19)^r(n,10)}function d(n,t){var r,d,f,l,p,h,b,g,v,m,y,k,_=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),w=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),T=new Array(64);n[t>>5]|=128<<24-t%32,n[(t+64>>9<<4)+15]=t;for(var v=0;v<n.length;v+=16){r=w[0],d=w[1],f=w[2],l=w[3],p=w[4],h=w[5],b=w[6],g=w[7];for(var m=0;64>m;m++)T[m]=16>m?n[m+v]:e(e(e(s(T[m-2]),T[m-7]),u(T[m-15])),T[m-16]),y=e(e(e(e(g,c(p)),i(p,h,b)),_[m]),T[m]),k=e(o(r),a(r,d,f)),g=b,b=h,h=p,p=e(l,y),l=f,f=d,d=r,r=e(y,k);w[0]=e(r,w[0]),w[1]=e(d,w[1]),w[2]=e(f,w[2]),w[3]=e(l,w[3]),w[4]=e(p,w[4]),w[5]=e(h,w[5]),w[6]=e(b,w[6]),w[7]=e(g,w[7])}return w}function f(n){for(var e=Array(),t=(1<<h)-1,r=0;r<n.length*h;r+=h)e[r>>5]|=(n.charCodeAt(r/h)&t)<<24-r%32;return e}function l(n){n=n.replace(/\r\n/g,"\n");for(var e="",t=0;t<n.length;t++){var r=n.charCodeAt(t);128>r?e+=String.fromCharCode(r):r>127&&2048>r?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e}function p(n){for(var e=b?"0123456789ABCDEF":"0123456789abcdef",t="",r=0;r<4*n.length;r++)t+=e.charAt(n[r>>2]>>8*(3-r%4)+4&15)+e.charAt(n[r>>2]>>8*(3-r%4)&15);return t}var h=8,b=0;return n=l(n),p(d(f(n),n.length*h))}var e=L;e.size(256);var t=e.s2a("0123456789012345");return{encrypt:function(r,i){if(!i)return r;var a=e.s2a(n(i).slice(0,32)),o=e.s2a(JSON.stringify(r)),c=e.rawEncrypt(o,a,t),u=e.Base64.encode(c);return u||r},decrypt:function(r,i){if(!i)return r;var a=e.s2a(n(i).slice(0,32));try{var o=e.Base64.decode(r),c=e.rawDecrypt(o,a,t,!1),u=JSON.parse(c);return u}catch(s){return void 0}}}}var y=1,_=!1,w=[],T="-pnpres",S=10,C=310,M=60,x=1e3,A="/",I="&",P=5,E=30,B="3.7.2",U=/{([\w\-]+)}/g,O=function(){var n=20,e=Math.floor(Math.random()*n);return function(t,r){return t.indexOf("pubsub.")>0&&t.replace("pubsub","ps"+(r?s().split("-")[0]:++e<n?e:e=1))||t}}(),L=function(){var n=14,e=8,t=!1,r=function(n){try{return unescape(encodeURIComponent(n))}catch(e){throw"Error on UTF-8 encode"}},a=function(n){try{return decodeURIComponent(escape(n))}catch(e){throw"Bad Key"}},o=function(n){var e,t,r=[];for(n.length<16&&(e=16-n.length,r=[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e]),t=0;t<n.length;t++)r[t]=n[t];return r},c=function(n,e){var t,r,i="";if(e){if(t=n[15],t>16)throw"Decryption error: Maybe bad key";if(16==t)return"";for(r=0;16-t>r;r++)i+=String.fromCharCode(n[r])}else for(r=0;16>r;r++)i+=String.fromCharCode(n[r]);return i},u=function(n){var e,t="";for(e=0;e<n.length;e++)t+=(n[e]<16?"0":"")+n[e].toString(16);return t},s=function(n){var e=[];return n.replace(/(..)/g,function(n){e.push(parseInt(n,16))}),e},d=function(n,e){var t,i=[];for(e||(n=r(n)),t=0;t<n.length;t++)i[t]=n.charCodeAt(t);return i},f=function(t){switch(t){case 128:n=10,e=4;break;case 192:n=12,e=6;break;case 256:n=14,e=8;break;default:throw"Invalid Key Size Specified:"+t}},l=function(n){var e,t=[];for(e=0;n>e;e++)t=t.concat(Math.floor(256*Math.random()));return t},p=function(t,r){var i,a=n>=12?3:2,o=[],c=[],u=[],s=[],d=t.concat(r);for(u[0]=GibberishAES.Hash.MD5(d),s=u[0],i=1;a>i;i++)u[i]=GibberishAES.Hash.MD5(u[i-1].concat(d)),s=s.concat(u[i]);return o=s.slice(0,4*e),c=s.slice(4*e,4*e+16),{key:o,iv:c}},h=function(n,e,t){e=T(e);var r,i=Math.ceil(n.length/16),a=[],c=[];for(r=0;i>r;r++)a[r]=o(n.slice(16*r,16*r+16));for(n.length%16===0&&(a.push([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),i++),r=0;r<a.length;r++)a[r]=0===r?w(a[r],t):w(a[r],c[r-1]),c[r]=g(a[r],e);return c},b=function(n,e,t,r){e=T(e);var i,o=n.length/16,u=[],s=[],d="";for(i=0;o>i;i++)u.push(n.slice(16*i,16*(i+1)));for(i=u.length-1;i>=0;i--)s[i]=v(u[i],e),s[i]=0===i?w(s[i],t):w(s[i],u[i-1]);for(i=0;o-1>i;i++)d+=c(s[i]);return d+=c(s[i],!0),r?d:a(d)},g=function(e,r){t=!1;var i,a=_(e,r,0);for(i=1;n+1>i;i++)a=m(a),a=y(a),n>i&&(a=k(a)),a=_(a,r,i);return a},v=function(e,r){t=!0;var i,a=_(e,r,n);for(i=n-1;i>-1;i--)a=y(a),a=m(a),a=_(a,r,i),i>0&&(a=k(a));return a},m=function(n){var e,r=t?E:P,i=[];for(e=0;16>e;e++)i[e]=r[n[e]];return i},y=function(n){var e,r=[],i=t?[0,13,10,7,4,1,14,11,8,5,2,15,12,9,6,3]:[0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11];for(e=0;16>e;e++)r[e]=n[i[e]];return r},k=function(n){var e,r=[];if(t)for(e=0;4>e;e++)r[4*e]=D[n[4*e]]^N[n[1+4*e]]^j[n[2+4*e]]^L[n[3+4*e]],r[1+4*e]=L[n[4*e]]^D[n[1+4*e]]^N[n[2+4*e]]^j[n[3+4*e]],r[2+4*e]=j[n[4*e]]^L[n[1+4*e]]^D[n[2+4*e]]^N[n[3+4*e]],r[3+4*e]=N[n[4*e]]^j[n[1+4*e]]^L[n[2+4*e]]^D[n[3+4*e]];else for(e=0;4>e;e++)r[4*e]=U[n[4*e]]^O[n[1+4*e]]^n[2+4*e]^n[3+4*e],r[1+4*e]=n[4*e]^U[n[1+4*e]]^O[n[2+4*e]]^n[3+4*e],r[2+4*e]=n[4*e]^n[1+4*e]^U[n[2+4*e]]^O[n[3+4*e]],r[3+4*e]=O[n[4*e]]^n[1+4*e]^n[2+4*e]^U[n[3+4*e]];return r},_=function(n,e,t){var r,i=[];for(r=0;16>r;r++)i[r]=n[r]^e[t][r];return i},w=function(n,e){var t,r=[];for(t=0;16>t;t++)r[t]=n[t]^e[t];return r},T=function(t){var r,i,a,o,c=[],u=[],s=[];for(r=0;e>r;r++)i=[t[4*r],t[4*r+1],t[4*r+2],t[4*r+3]],c[r]=i;for(r=e;4*(n+1)>r;r++){for(c[r]=[],a=0;4>a;a++)u[a]=c[r-1][a];for(r%e===0?(u=S(C(u)),u[0]^=B[r/e-1]):e>6&&r%e==4&&(u=S(u)),a=0;4>a;a++)c[r][a]=c[r-e][a]^u[a]}for(r=0;n+1>r;r++)for(s[r]=[],o=0;4>o;o++)s[r].push(c[4*r+o][0],c[4*r+o][1],c[4*r+o][2],c[4*r+o][3]);return s},S=function(n){for(var e=0;4>e;e++)n[e]=P[n[e]];return n},C=function(n){var e,t=n[0];for(e=0;4>e;e++)n[e]=n[e+1];return n[3]=t,n},M=function(n,e){var t=[];for(i=0;i<n.length;i+=e)t[i/e]=parseInt(n.substr(i,e),16);return t},x=function(n){var e=[];for(i=0;i<n.length;i++)e[n[i]]=i;return e},A=function(n,e){var t,r;for(r=0,t=0;8>t;t++)r=1==(1&e)?r^n:r,n=n>127?283^n<<1:n<<1,e>>>=1;return r},I=function(n){for(var e=[],t=0;256>t;t++)e[t]=A(n,t);return e},P=M("637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0b7fd9326363ff7cc34a5e5f171d8311504c723c31896059a071280e2eb27b27509832c1a1b6e5aa0523bd6b329e32f8453d100ed20fcb15b6acbbe394a4c58cfd0efaafb434d338545f9027f503c9fa851a3408f929d38f5bcb6da2110fff3d2cd0c13ec5f974417c4a77e3d645d197360814fdc222a908846eeb814de5e0bdbe0323a0a4906245cc2d3ac629195e479e7c8376d8dd54ea96c56f4ea657aae08ba78252e1ca6b4c6e8dd741f4bbd8b8a703eb5664803f60e613557b986c11d9ee1f8981169d98e949b1e87e9ce5528df8ca1890dbfe6426841992d0fb054bb16",2),E=x(P),B=M("01020408102040801b366cd8ab4d9a2f5ebc63c697356ad4b37dfaefc591",2),U=I(2),O=I(3),L=I(9),N=I(11),j=I(13),D=I(14),R=function(n,e,t){var r,i=l(8),a=p(d(e,t),i),o=a.key,c=a.iv,u=[[83,97,108,116,101,100,95,95].concat(i)];return n=d(n,t),r=h(n,o,c),r=u.concat(r),W.encode(r)},K=function(n,e,t){var r=W.decode(n),i=r.slice(8,16),a=p(d(e,t),i),o=a.key,c=a.iv;return r=r.slice(16,r.length),n=b(r,o,c,t)},H=function(n){function e(n,e){return n<<e|n>>>32-e}function t(n,e){var t,r,i,a,o;return i=2147483648&n,a=2147483648&e,t=1073741824&n,r=1073741824&e,o=(1073741823&n)+(1073741823&e),t&r?2147483648^o^i^a:t|r?1073741824&o?3221225472^o^i^a:1073741824^o^i^a:o^i^a}function r(n,e,t){return n&e|~n&t}function i(n,e,t){return n&t|e&~t}function a(n,e,t){return n^e^t}function o(n,e,t){return e^(n|~t)}function c(n,i,a,o,c,u,s){return n=t(n,t(t(r(i,a,o),c),s)),t(e(n,u),i)}function u(n,r,a,o,c,u,s){return n=t(n,t(t(i(r,a,o),c),s)),t(e(n,u),r)}function s(n,r,i,o,c,u,s){return n=t(n,t(t(a(r,i,o),c),s)),t(e(n,u),r)}function d(n,r,i,a,c,u,s){return n=t(n,t(t(o(r,i,a),c),s)),t(e(n,u),r)}function f(n){for(var e,t=n.length,r=t+8,i=(r-r%64)/64,a=16*(i+1),o=[],c=0,u=0;t>u;)e=(u-u%4)/4,c=u%4*8,o[e]=o[e]|n[u]<<c,u++;return e=(u-u%4)/4,c=u%4*8,o[e]=o[e]|128<<c,o[a-2]=t<<3,o[a-1]=t>>>29,o}function l(n){var e,t,r=[];for(t=0;3>=t;t++)e=n>>>8*t&255,r=r.concat(e);return r}var p,h,b,g,v,m,y,k,_,w=[],T=M("67452301efcdab8998badcfe10325476d76aa478e8c7b756242070dbc1bdceeef57c0faf4787c62aa8304613fd469501698098d88b44f7afffff5bb1895cd7be6b901122fd987193a679438e49b40821f61e2562c040b340265e5a51e9b6c7aad62f105d02441453d8a1e681e7d3fbc821e1cde6c33707d6f4d50d87455a14eda9e3e905fcefa3f8676f02d98d2a4c8afffa39428771f6816d9d6122fde5380ca4beea444bdecfa9f6bb4b60bebfbc70289b7ec6eaa127fad4ef308504881d05d9d4d039e6db99e51fa27cf8c4ac5665f4292244432aff97ab9423a7fc93a039655b59c38f0ccc92ffeff47d85845dd16fa87e4ffe2ce6e0a30143144e0811a1f7537e82bd3af2352ad7d2bbeb86d391",8);for(w=f(n),m=T[0],y=T[1],k=T[2],_=T[3],p=0;p<w.length;p+=16)h=m,b=y,g=k,v=_,m=c(m,y,k,_,w[p+0],7,T[4]),_=c(_,m,y,k,w[p+1],12,T[5]),k=c(k,_,m,y,w[p+2],17,T[6]),y=c(y,k,_,m,w[p+3],22,T[7]),m=c(m,y,k,_,w[p+4],7,T[8]),_=c(_,m,y,k,w[p+5],12,T[9]),k=c(k,_,m,y,w[p+6],17,T[10]),y=c(y,k,_,m,w[p+7],22,T[11]),m=c(m,y,k,_,w[p+8],7,T[12]),_=c(_,m,y,k,w[p+9],12,T[13]),k=c(k,_,m,y,w[p+10],17,T[14]),y=c(y,k,_,m,w[p+11],22,T[15]),m=c(m,y,k,_,w[p+12],7,T[16]),_=c(_,m,y,k,w[p+13],12,T[17]),k=c(k,_,m,y,w[p+14],17,T[18]),y=c(y,k,_,m,w[p+15],22,T[19]),m=u(m,y,k,_,w[p+1],5,T[20]),_=u(_,m,y,k,w[p+6],9,T[21]),k=u(k,_,m,y,w[p+11],14,T[22]),y=u(y,k,_,m,w[p+0],20,T[23]),m=u(m,y,k,_,w[p+5],5,T[24]),_=u(_,m,y,k,w[p+10],9,T[25]),k=u(k,_,m,y,w[p+15],14,T[26]),y=u(y,k,_,m,w[p+4],20,T[27]),m=u(m,y,k,_,w[p+9],5,T[28]),_=u(_,m,y,k,w[p+14],9,T[29]),k=u(k,_,m,y,w[p+3],14,T[30]),y=u(y,k,_,m,w[p+8],20,T[31]),m=u(m,y,k,_,w[p+13],5,T[32]),_=u(_,m,y,k,w[p+2],9,T[33]),k=u(k,_,m,y,w[p+7],14,T[34]),y=u(y,k,_,m,w[p+12],20,T[35]),m=s(m,y,k,_,w[p+5],4,T[36]),_=s(_,m,y,k,w[p+8],11,T[37]),k=s(k,_,m,y,w[p+11],16,T[38]),y=s(y,k,_,m,w[p+14],23,T[39]),m=s(m,y,k,_,w[p+1],4,T[40]),_=s(_,m,y,k,w[p+4],11,T[41]),k=s(k,_,m,y,w[p+7],16,T[42]),y=s(y,k,_,m,w[p+10],23,T[43]),m=s(m,y,k,_,w[p+13],4,T[44]),_=s(_,m,y,k,w[p+0],11,T[45]),k=s(k,_,m,y,w[p+3],16,T[46]),y=s(y,k,_,m,w[p+6],23,T[47]),m=s(m,y,k,_,w[p+9],4,T[48]),_=s(_,m,y,k,w[p+12],11,T[49]),k=s(k,_,m,y,w[p+15],16,T[50]),y=s(y,k,_,m,w[p+2],23,T[51]),m=d(m,y,k,_,w[p+0],6,T[52]),_=d(_,m,y,k,w[p+7],10,T[53]),k=d(k,_,m,y,w[p+14],15,T[54]),y=d(y,k,_,m,w[p+5],21,T[55]),m=d(m,y,k,_,w[p+12],6,T[56]),_=d(_,m,y,k,w[p+3],10,T[57]),k=d(k,_,m,y,w[p+10],15,T[58]),y=d(y,k,_,m,w[p+1],21,T[59]),m=d(m,y,k,_,w[p+8],6,T[60]),_=d(_,m,y,k,w[p+15],10,T[61]),k=d(k,_,m,y,w[p+6],15,T[62]),y=d(y,k,_,m,w[p+13],21,T[63]),m=d(m,y,k,_,w[p+4],6,T[64]),_=d(_,m,y,k,w[p+11],10,T[65]),k=d(k,_,m,y,w[p+2],15,T[66]),y=d(y,k,_,m,w[p+9],21,T[67]),m=t(m,h),y=t(y,b),k=t(k,g),_=t(_,v);return l(m).concat(l(y),l(k),l(_))},W=function(){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=n.split(""),t=function(n){{var t,r,i=[],a="";Math.floor(16*n.length/3)}for(t=0;t<16*n.length;t++)i.push(n[Math.floor(t/16)][t%16]);for(t=0;t<i.length;t+=3)a+=e[i[t]>>2],a+=e[(3&i[t])<<4|i[t+1]>>4],a+=void 0!==i[t+1]?e[(15&i[t+1])<<2|i[t+2]>>6]:"=",a+=void 0!==i[t+2]?e[63&i[t+2]]:"=";for(r=a.slice(0,64),t=1;t<Math.ceil(a.length/64);t++)r+=a.slice(64*t,64*t+64)+(Math.ceil(a.length/64)==t+1?"":"\n");return r},r=function(e){e=e.replace(/\n/g,"");var t,r=[],i=[],a=[];for(t=0;t<e.length;t+=4)i[0]=n.indexOf(e.charAt(t)),i[1]=n.indexOf(e.charAt(t+1)),i[2]=n.indexOf(e.charAt(t+2)),i[3]=n.indexOf(e.charAt(t+3)),a[0]=i[0]<<2|i[1]>>4,a[1]=(15&i[1])<<4|i[2]>>2,a[2]=(3&i[2])<<6|i[3],r.push(a[0],a[1],a[2]);return r=r.slice(0,r.length-r.length%16)};return"function"==typeof Array.indexOf&&(n=e),{encode:t,decode:r}}();return{size:f,h2a:s,expandKey:T,encryptBlock:g,decryptBlock:v,Decrypt:t,s2a:d,rawEncrypt:h,rawDecrypt:b,dec:K,openSSLKey:p,a2h:u,enc:R,Hash:{MD5:H},Base64:W}}();!function(){function n(n){function e(){Ti.Stream.read(h,s,function(n){if(+n.bytesProcessed>-1)return t=Ti.Codec.decodeString({source:s,length:+n.bytesProcessed}),c.push(t),s.clear(),u(e,1);try{t=JSON.parse(c.join("").split("\r\n").slice(-1))}catch(r){return l()}h.close(),p(t)})}var t=n.data||{};t.pnsdk=i;var o=r(n.url,t),c=[],t="",s=Ti.createBuffer({length:2048}),d=Ti.createBuffer({value:"GET "+o+" HTTP/1.0\n\n"}),f=0,l=function(){f||(f=1,(n.fail||function(){})())},p=n.success||function(){},h=Ti.Network.Socket.createTCP({host:o.split(A)[2],port:80,mode:Ti.Network.READ_WRITE_MODE,timeout:a,error:l,connected:function(){h.write(d),e()}});try{h.connect()}catch(b){return l()}}function e(n){var e=n.data||{};e.pnsdk=i;var t,o=r(n.url,e),c=function(){if(!d){d=1,clearTimeout(f);try{response=JSON.parse(t.responseText)}catch(n){return h(1)}p(response)}},s=0,d=0,f=u(function(){h(1)},a),l=n.fail||function(){},p=n.success||function(){},h=function(n){s||(s=1,clearTimeout(f),t&&(t.onerror=t.onload=null,t.abort&&t.abort(),t=null),n&&l())};try{t=Ti.Network.createHTTPClient(),t.onerror=function(){h(1)},t.onload=c,t.timeout=a,t.open("GET",o,!0),t.send()}catch(b){return h(0),xdr(n)}return h}function t(r){r.db=o,r.xdr=r.native_tcp_socket?n:e,r.crypto_obj=m(),r.params={pnsdk:i},SELF=function(n){return t(n)};var a=v(r);for(var c in a)a.hasOwnProperty(c)&&(SELF[c]=a[c]);return SELF.init=SELF,r.notest?SELF:(SELF.ready(),SELF)}var i="PubNub-JS-Titanium/3.7.2",a=(Ti.Platform.name.toLowerCase().indexOf("android")>=0,31e4),o=function(){return{get:function(n){Ti.App.Properties.getString(""+n)},set:function(n,e){Ti.App.Properties.setString(""+n,""+e)}}}();t.init=t,"undefined"!=typeof module&&(module.exports=t)||"undefined"!=typeof exports&&(exports.PN=t)||(PUBNUB=t)}()}();